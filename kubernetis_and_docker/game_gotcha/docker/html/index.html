<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Catch-a-Match!</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f0f12;
      --surface: #1a1a20;
      --border: #2d2d36;
      --text: #e8e6e3;
      --muted: #8b8792;
      --accent: #7c6cf9;
      --accent-dim: #5b4dd4;
      --success: #4ade80;
      --danger: #f87171;
      --warning: #fbbf24;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Outfit', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      background-image:
        radial-gradient(ellipse 80% 50% at 50% -20%, rgba(124, 108, 249, 0.15), transparent),
        radial-gradient(ellipse 60% 40% at 80% 100%, rgba(124, 108, 249, 0.08), transparent);
    }

    .game-container {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 2.5rem;
      max-width: 520px;
      width: 100%;
      box-shadow: 0 24px 48px rgba(0, 0, 0, 0.4);
    }

    h1 {
      font-size: 1.75rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 0.5rem;
      letter-spacing: -0.02em;
    }

    .btn {
      font-family: 'Outfit', sans-serif;
      font-weight: 600;
      font-size: 0.95rem;
      padding: 0.75rem 1.25rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.1s, background 0.2s;
    }

    .btn:hover { transform: translateY(-1px); }
    .btn:active { transform: translateY(0); }

    /* ‚îÄ‚îÄ catch‚Äëthe‚Äëname prompt ‚îÄ‚îÄ */
    .catch-prompt {
      text-align: center;
      margin: 0.75rem 0 0.5rem;
      font-size: 1rem;
      color: var(--muted);
    }

    .catch-prompt .target-name {
      display: inline-block;
      font-size: 1.6rem;
      font-weight: 700;
      color: var(--warning);
      letter-spacing: 0.04em;
      text-shadow: 0 0 12px rgba(251, 191, 36, 0.45);
      animation: pulse 1.2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50%       { opacity: 0.75; transform: scale(1.08); }
    }

    /* ‚îÄ‚îÄ stats row ‚îÄ‚îÄ */
    .stats-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--muted);
      margin-bottom: 1rem;
    }

    .stats-row .stat-score { color: var(--success); }
    .stats-row .stat-round { color: var(--accent); }

    /* ‚îÄ‚îÄ arena ‚îÄ‚îÄ */
    .catch-arena {
      position: relative;
      width: 100%;
      height: 240px;
      background: var(--bg);
      border: 2px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
      cursor: crosshair;
      margin-bottom: 1rem;
    }

    .catch-arena.catch-disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* ‚îÄ‚îÄ name targets ‚îÄ‚îÄ */
    .name-target {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      pointer-events: none;
      user-select: none;
    }

    .name-target img {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      object-fit: cover;
      display: block;
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.55);
    }

    .name-target .name-label {
      font-family: 'Outfit', sans-serif;
      font-weight: 700;
      font-size: 0.8rem;
      white-space: nowrap;
      padding: 2px 10px;
      border-radius: 999px;
    }

    .name-target.name-ayaan img   { border: 3px solid #7c6cf9; }
    .name-target.name-ayaan .name-label {
      background: rgba(124, 108, 249, 0.3);
      color: #c4baff;
    }

    .name-target.name-ayna img    { border: 3px solid #f87171; }
    .name-target.name-ayna .name-label {
      background: rgba(248, 113, 113, 0.25);
      color: #fca5a5;
    }

    /* ‚îÄ‚îÄ result message ‚îÄ‚îÄ */
    .catch-message {
      text-align: center;
      font-size: 1rem;
      font-weight: 600;
      padding: 0.75rem;
      border-radius: 8px;
      margin-bottom: 0.75rem;
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      visibility: hidden;
    }

    .catch-message.show { visibility: visible; }

    .catch-message.caught {
      background: rgba(74, 222, 128, 0.15);
      color: var(--success);
    }

    .catch-message.missed {
      background: rgba(248, 113, 113, 0.15);
      color: var(--danger);
    }

    /* ‚îÄ‚îÄ score board ‚îÄ‚îÄ */
    .scoreboard {
      display: none;
      text-align: center;
      padding: 1.25rem 0 0.5rem;
    }

    .scoreboard.show { display: block; }

    .scoreboard h2 {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .score-big {
      font-size: 3rem;
      font-weight: 700;
      line-height: 1;
      margin: 0.5rem 0;
    }

    .score-label {
      font-size: 0.9rem;
      color: var(--muted);
      margin-bottom: 1.25rem;
    }

    .score-excellent { color: var(--success); }
    .score-good      { color: var(--warning); }
    .score-bad       { color: var(--danger); }

    /* ‚îÄ‚îÄ start button ‚îÄ‚îÄ */
    .btn-catch-start {
      display: block;
      width: 100%;
      background: var(--accent);
      color: white;
      margin-bottom: 0.5rem;
    }

    .btn-catch-start:hover { background: var(--accent-dim); }

    /* ‚îÄ‚îÄ name entry ‚îÄ‚îÄ */
    .name-entry {
      display: none;
      flex-direction: column;
      gap: 0.6rem;
      margin-bottom: 1rem;
    }

    .name-entry.show { display: flex; }

    .name-entry label {
      font-size: 0.85rem;
      color: var(--muted);
      font-weight: 600;
    }

    .name-entry input {
      font-family: 'Outfit', sans-serif;
      font-size: 1rem;
      padding: 0.6rem 0.9rem;
      border-radius: 8px;
      border: 1.5px solid var(--border);
      background: var(--bg);
      color: var(--text);
      outline: none;
      transition: border-color 0.2s;
    }

    .name-entry input:focus { border-color: var(--accent); }

    /* ‚îÄ‚îÄ leaderboard ‚îÄ‚îÄ */
    .leaderboard {
      margin-top: 1.5rem;
      border-top: 1px solid var(--border);
      padding-top: 1.25rem;
    }

    .leaderboard h3 {
      font-size: 1rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 0.9rem;
      letter-spacing: 0.03em;
      color: var(--accent);
    }

    .lb-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.88rem;
    }

    .lb-table thead th {
      color: var(--muted);
      font-weight: 600;
      padding: 0 0.5rem 0.5rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    .lb-table thead th.col-rank  { width: 2rem; text-align: center; }
    .lb-table thead th.col-score { width: 4rem; text-align: center; }

    .lb-table tbody tr {
      border-bottom: 1px solid rgba(255,255,255,0.04);
      transition: background 0.15s;
    }

    .lb-table tbody tr:hover { background: rgba(255,255,255,0.03); }

    .lb-table tbody tr.lb-me { background: rgba(124, 108, 249, 0.1); }

    .lb-table tbody td {
      padding: 0.45rem 0.5rem;
      vertical-align: middle;
    }

    .lb-table tbody td.col-rank {
      text-align: center;
      font-weight: 700;
      font-size: 0.95rem;
    }

    .lb-rank-1 { color: #fbbf24; }
    .lb-rank-2 { color: #94a3b8; }
    .lb-rank-3 { color: #cd7c3a; }

    .lb-table tbody td.col-score {
      text-align: center;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
    }

    .lb-score-excellent { color: var(--success); }
    .lb-score-good      { color: var(--warning); }
    .lb-score-bad       { color: var(--danger); }

    .lb-date {
      color: var(--muted);
      font-size: 0.78rem;
    }

    .lb-empty {
      text-align: center;
      color: var(--muted);
      padding: 1rem 0;
      font-size: 0.9rem;
    }

    .btn-lb-clear {
      display: block;
      width: 100%;
      margin-top: 0.75rem;
      background: transparent;
      border: 1px solid var(--border);
      color: var(--muted);
      font-size: 0.8rem;
      padding: 0.5rem;
    }

    .btn-lb-clear:hover {
      border-color: var(--danger);
      color: var(--danger);
      transform: none;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <section class="catch-section">
      <h1>Catch-a-Match!</h1>

      <div class="catch-prompt" id="catchPrompt">
        Catch&nbsp;<span class="target-name" id="targetNameLabel">‚Äî</span>
      </div>

      <div class="stats-row">
        <span class="stat-round"  id="statRound">Round: 0 / 5</span>
        <span class="stat-score"  id="statScore">Score: 0</span>
      </div>

      <div class="catch-arena catch-disabled" id="catchArena">
        <div class="name-target name-ayaan" id="targetAyaan">
          <img src="images/ayaan.png" alt="Ayaan" />
          <span class="name-label">Ayaan</span>
        </div>
        <div class="name-target name-ayna" id="targetAyna">
          <img src="images/ayna.png" alt="Ayna" />
          <span class="name-label">Ayna</span>
        </div>
      </div>

      <div class="catch-message" id="catchMessage"></div>

      <div class="scoreboard" id="scoreboard">
        <h2>Game Over!</h2>
        <div class="score-big" id="scoreBig"></div>
        <div class="score-label">out of 5 rounds</div>
      </div>

      <div class="name-entry show" id="nameEntry">
        <label for="playerNameInput">Your name</label>
        <input type="text" id="playerNameInput" placeholder="Enter your name‚Ä¶" maxlength="24" autocomplete="off" />
      </div>

      <button class="btn btn-catch-start" id="catchStartBtn">Start Game</button>

      <!-- leaderboard (always visible) -->
      <div class="leaderboard" id="leaderboard">
        <h3>üèÜ Leaderboard</h3>
        <table class="lb-table">
          <thead>
            <tr>
              <th class="col-rank">#</th>
              <th>Player</th>
              <th class="col-score">Score</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody id="lbBody"></tbody>
        </table>
        <button class="btn btn-lb-clear" id="lbClearBtn">Clear leaderboard</button>
      </div>
    </section>
  </div>

  <script>
    const catchArena       = document.getElementById('catchArena');
    const catchMessage     = document.getElementById('catchMessage');
    const catchStartBtn    = document.getElementById('catchStartBtn');
    const targetNameLabel  = document.getElementById('targetNameLabel');
    const statRound        = document.getElementById('statRound');
    const statScore        = document.getElementById('statScore');
    const scoreboard       = document.getElementById('scoreboard');
    const scoreBig         = document.getElementById('scoreBig');
    const nameEntry        = document.getElementById('nameEntry');
    const playerNameInput  = document.getElementById('playerNameInput');
    const lbBody           = document.getElementById('lbBody');
    const lbClearBtn       = document.getElementById('lbClearBtn');

    const domTargets = {
      Ayaan: document.getElementById('targetAyaan'),
      Ayna:  document.getElementById('targetAyna'),
    };

    const NAMES        = ['Ayaan', 'Ayna'];
    const MAX_ROUNDS   = 5;
    const SPEED_MIN    = 2.5;
    const SPEED_MAX    = 4.5;
    const LB_KEY       = 'catchamatch_leaderboard';
    const LB_MAX_ROWS  = 10;

    let gameActive   = false;
    let round        = 0;
    let score        = 0;
    let roundActive  = false;
    let targetName   = '';
    let animationIds = {};
    let positions    = {};
    let currentPlayer = '';

    /* ‚îÄ‚îÄ helpers ‚îÄ‚îÄ */
    function rand(min, max) { return min + Math.random() * (max - min); }
    function randSign()     { return Math.random() > 0.5 ? 1 : -1; }

    function updateStats() {
      statRound.textContent = 'Round: ' + round + ' / ' + MAX_ROUNDS;
      statScore.textContent = 'Score: ' + score;
    }

    function showMessage(text, type) {
      catchMessage.className = 'catch-message show ' + type;
      catchMessage.textContent = text;
    }

    function hideMessage() {
      catchMessage.className = 'catch-message';
      catchMessage.textContent = '';
    }

    /* ‚îÄ‚îÄ leaderboard (localStorage) ‚îÄ‚îÄ */
    function loadLB() {
      try { return JSON.parse(localStorage.getItem(LB_KEY)) || []; }
      catch { return []; }
    }

    function saveLB(entries) {
      localStorage.setItem(LB_KEY, JSON.stringify(entries));
    }

    function addToLB(name, s) {
      const entries = loadLB();
      entries.push({
        name: name || 'Anonymous',
        score: s,
        date: new Date().toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: '2-digit' })
      });
      entries.sort((a, b) => b.score - a.score || 0);
      saveLB(entries.slice(0, LB_MAX_ROWS));
    }

    function scoreClass(s) {
      const pct = s / MAX_ROUNDS;
      return pct >= 0.8 ? 'lb-score-excellent' : pct >= 0.5 ? 'lb-score-good' : 'lb-score-bad';
    }

    function rankMedal(i) {
      if (i === 0) return '<span class="lb-rank-1">ü•á</span>';
      if (i === 1) return '<span class="lb-rank-2">ü•à</span>';
      if (i === 2) return '<span class="lb-rank-3">ü•â</span>';
      return i + 1;
    }

    function renderLB(highlightName) {
      const entries = loadLB();
      if (entries.length === 0) {
        lbBody.innerHTML = '<tr><td colspan="4" class="lb-empty">No scores yet ‚Äî be the first!</td></tr>';
        return;
      }
      lbBody.innerHTML = entries.map((e, i) => {
        const isMe = highlightName && e.name === highlightName;
        return `<tr class="${isMe ? 'lb-me' : ''}">
          <td class="col-rank">${rankMedal(i)}</td>
          <td>${e.name}${isMe ? ' <span style="font-size:0.75rem;color:var(--accent);">(you)</span>' : ''}</td>
          <td class="col-score ${scoreClass(e.score)}">${e.score} / ${MAX_ROUNDS}</td>
          <td class="lb-date">${e.date}</td>
        </tr>`;
      }).join('');
    }

    /* ‚îÄ‚îÄ animation ‚îÄ‚îÄ */
    function getArenaSize() {
      return { w: catchArena.clientWidth, h: catchArena.clientHeight };
    }

    function moveTarget(name) {
      if (!gameActive || !roundActive) return;
      const arena = getArenaSize();
      const p = positions[name];
      const el = domTargets[name];

      p.x += p.vx;
      p.y += p.vy;

      if (p.x <= 0)             { p.x = 0;             p.vx = Math.abs(p.vx); }
      if (p.x >= arena.w - p.w) { p.x = arena.w - p.w; p.vx = -Math.abs(p.vx); }
      if (p.y <= 0)             { p.y = 0;             p.vy = Math.abs(p.vy); }
      if (p.y >= arena.h - p.h) { p.y = arena.h - p.h; p.vy = -Math.abs(p.vy); }

      el.style.left = p.x + 'px';
      el.style.top  = p.y + 'px';

      animationIds[name] = requestAnimationFrame(() => moveTarget(name));
    }

    function stopAnimations() {
      NAMES.forEach(n => {
        if (animationIds[n]) {
          cancelAnimationFrame(animationIds[n]);
          animationIds[n] = null;
        }
      });
    }

    /* ‚îÄ‚îÄ round lifecycle ‚îÄ‚îÄ */
    function startRound() {
      hideMessage();
      roundActive = false;

      targetName = NAMES[Math.floor(Math.random() * NAMES.length)];
      targetNameLabel.textContent = targetName;

      const arena = getArenaSize();

      NAMES.forEach(name => {
        const el = domTargets[name];
        el.style.left = '0px';
        el.style.top  = '0px';
        el.style.visibility = 'visible';

        const w = el.offsetWidth;
        const h = el.offsetHeight;

        const x = rand(0, Math.max(0, arena.w - w));
        const y = rand(0, Math.max(0, arena.h - h));

        positions[name] = {
          x, y,
          vx: rand(SPEED_MIN, SPEED_MAX) * randSign(),
          vy: rand(SPEED_MIN, SPEED_MAX) * randSign(),
          w, h
        };

        el.style.left = x + 'px';
        el.style.top  = y + 'px';
      });

      roundActive = true;
      NAMES.forEach(n => moveTarget(n));
    }

    function endRound(caught) {
      roundActive = false;
      stopAnimations();

      if (caught) {
        score++;
        showMessage('‚úì Caught ' + targetName + '!', 'caught');
      } else {
        showMessage('‚úó Missed! You needed to catch ' + targetName + '.', 'missed');
      }

      updateStats();

      if (round >= MAX_ROUNDS) {
        setTimeout(showFinalScore, 900);
      } else {
        setTimeout(startRound, 1000);
      }
    }

    function showFinalScore() {
      gameActive = false;
      catchArena.classList.add('catch-disabled');
      scoreboard.classList.add('show');

      const pct = score / MAX_ROUNDS;
      scoreBig.textContent = score + ' / ' + MAX_ROUNDS;
      scoreBig.className   = 'score-big ' + (pct >= 0.8 ? 'score-excellent' : pct >= 0.5 ? 'score-good' : 'score-bad');

      /* save to leaderboard */
      addToLB(currentPlayer, score);
      renderLB(currentPlayer);

      nameEntry.classList.add('show');
      catchStartBtn.textContent = 'Play Again';
      catchStartBtn.style.display = 'block';
    }

    /* ‚îÄ‚îÄ click handler ‚îÄ‚îÄ */
    catchArena.addEventListener('click', (e) => {
      if (!gameActive || !roundActive) return;

      round++;
      updateStats();

      const clickedName = NAMES.find(name => {
        const p = positions[name];
        const rect = catchArena.getBoundingClientRect();
        const cx = e.clientX - rect.left;
        const cy = e.clientY - rect.top;
        return cx >= p.x && cx <= p.x + p.w && cy >= p.y && cy <= p.y + p.h;
      });

      endRound(clickedName === targetName);
    });

    /* ‚îÄ‚îÄ start / restart ‚îÄ‚îÄ */
    catchStartBtn.addEventListener('click', () => {
      currentPlayer = playerNameInput.value.trim() || 'Anonymous';

      round  = 0;
      score  = 0;
      gameActive = true;

      scoreboard.classList.remove('show');
      nameEntry.classList.remove('show');
      catchArena.classList.remove('catch-disabled');
      catchStartBtn.style.display = 'none';
      catchStartBtn.textContent   = 'Start Game';

      updateStats();
      startRound();
    });

    /* ‚îÄ‚îÄ clear leaderboard ‚îÄ‚îÄ */
    lbClearBtn.addEventListener('click', () => {
      if (confirm('Clear all leaderboard scores?')) {
        saveLB([]);
        renderLB();
      }
    });

    /* ‚îÄ‚îÄ init ‚îÄ‚îÄ */
    renderLB();
  </script>
</body>
</html>
